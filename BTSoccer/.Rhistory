x <- m$DesignMatrix;Y <- m$KontingensTabel; r <- m$SamledeKampe;
f <- BTFunktioner(x=x)
for (hold1 in 1:length(UnikHold)) {
for (hold2 in 1:length(UnikHold)) {
if (hold1 != hold2){
KumSSH[counter,] <- cbind(Sandsynligheder(,theta,x,hold1,hold2)[1],Sandsynligheder(,theta,x,hold1,hold2)[2],Sandsynligheder(,theta,x,hold1,hold2)[3],UnikHold[hold1],UnikHold[hold2])
counter = counter +1
}
}
}
#Fikser data og sætter Holdene sammen i én column
KumSSH <- as.data.frame.matrix(KumSSH)
names(KumSSH) <- c("H","U","Uafgjort","H1","H2")
KumSSH$H1H2 <- paste(KumSSH$H1,KumSSH$H2)
#KumSSH <- KumSSH[,c(1:3,6)]
KumSSH[,1]<-as.numeric(paste(KumSSH[,1]));KumSSH[,2] <- as.numeric(paste(KumSSH[,2]));KumSSH[,3] <- as.numeric(paste(KumSSH[,3]));
#Finder næste rundes kampe for at evaluere
data1 <- data[which((data$runde==(runde+1)) & (data$dato>="2015-07-19") & (data$dato <= "2016-05-29")),]
data1$HU <- paste(data1$H,data1$U)
#Finder dertilhørende ssh
KumSSH <- KumSSH[KumSSH$H1H2 %in% data1$HU,];
PointSSH <- rbind(PointSSH,KumSSH)
Observationer <- as.data.frame.matrix(cbind(data1$Hsejr,data1$Usejr,data1$Uafgjort,data1$HU));
Observationer <- Observationer[order(Observationer$V4),];Observationer[,1] <- as.numeric(paste(Observationer[,1]));Observationer[,2] <- as.numeric(paste(Observationer[,2]));Observationer[,3] <- as.numeric(paste(Observationer[,3]));
Fejl[runde-9] = sum(Observationer[,1:3]-(KumSSH[,1:3]*Observationer[,1:3]))
MeanStyrker = MeanStyrker + n$styrker
MeanBeta= MeanBeta + n$beta
MeanTheta = MeanTheta + n$theta
MeanSD = MeanSD + n$sd
cat("\n",n$styrker/(min(n$styrker)),"\n")
}
#Dynamisk model
MeanStyrker = 0;MeanBeta = 0; MeanTheta = 0; MeanSD = 0;
startrunde = 4;PointSSH = 0;PointSSH = c(0,0,0,"FCK","FCK","NN")
Fejl <- c(rep(0,length(unique(data$runde))-13))
for (runde in startrunde:(length(unique(data$runde))-4)) {
#Evaluerer modellen, ift. sandsynligheder for udfald mod de observerede udfald i næste runde
#Finder samtlige parvise sandsynligheder for ALLE sammenligninger
data1 <- data[which((data$runde <= runde) & (data$dato>="2015-07-19") & (data$dato<="2016-05-29")),]
m <- CreateMatrixes(data1,"2015-07-19","2016-05-29",0,FALSE)
x <- m$DesignMatrix;Y <- m$KontingensTabel; r <- m$SamledeKampe;
f <- BTFunktioner(x=x)
n <- NR(x,f);beta = n$beta;theta=n$theta;
styrker = n$styrker;
UnikHold <- sort(unique(data1$H))
counter = 1;KumSSH <- matrix(NA, nrow = (factorial(length(UnikHold))/(factorial((length(UnikHold)-2)))), ncol = 5)
m <- CreateMatrixes(data,"2015-07-19","2016-05-29",0,FALSE)
x <- m$DesignMatrix;Y <- m$KontingensTabel; r <- m$SamledeKampe;
f <- BTFunktioner(x=x)
for (hold1 in 1:length(UnikHold)) {
for (hold2 in 1:length(UnikHold)) {
if (hold1 != hold2){
KumSSH[counter,] <- cbind(Sandsynligheder(,theta,x,hold1,hold2)[1],Sandsynligheder(,theta,x,hold1,hold2)[2],Sandsynligheder(,theta,x,hold1,hold2)[3],UnikHold[hold1],UnikHold[hold2])
counter = counter +1
}
}
}
#Fikser data og sætter Holdene sammen i én column
KumSSH <- as.data.frame.matrix(KumSSH)
names(KumSSH) <- c("H","U","Uafgjort","H1","H2")
KumSSH$H1H2 <- paste(KumSSH$H1,KumSSH$H2)
#KumSSH <- KumSSH[,c(1:3,6)]
KumSSH[,1]<-as.numeric(paste(KumSSH[,1]));KumSSH[,2] <- as.numeric(paste(KumSSH[,2]));KumSSH[,3] <- as.numeric(paste(KumSSH[,3]));
#Finder næste rundes kampe for at evaluere
data1 <- data[which((data$runde==(runde+1)) & (data$dato>="2015-07-19") & (data$dato <= "2016-05-29")),]
data1$HU <- paste(data1$H,data1$U)
#Finder dertilhørende ssh
KumSSH <- KumSSH[KumSSH$H1H2 %in% data1$HU,];
PointSSH <- rbind(PointSSH,KumSSH)
Observationer <- as.data.frame.matrix(cbind(data1$Hsejr,data1$Usejr,data1$Uafgjort,data1$HU));
Observationer <- Observationer[order(Observationer$V4),];Observationer[,1] <- as.numeric(paste(Observationer[,1]));Observationer[,2] <- as.numeric(paste(Observationer[,2]));Observationer[,3] <- as.numeric(paste(Observationer[,3]));
Fejl[runde-9] = sum(Observationer[,1:3]-(KumSSH[,1:3]*Observationer[,1:3]))
MeanStyrker = MeanStyrker + n$styrker/(min(n$styrker))
MeanBeta= MeanBeta + n$beta
MeanTheta = MeanTheta + n$theta
MeanSD = MeanSD + n$sd
cat("\n",n$styrker/(min(n$styrker)),"\n")
}
MeanStyrker/min(MeanStyrker)
styrker = n$styrker/min(n$styrker)
#Til at estimere point, ssh*point for udfald, eks: (0.34,0.26,0.5)*(3,3,1)
data1 <- data[which((data$dato>="2015-07-19") & (data$dato<="2016-05-29")),]
UnikHold <- sort(unique(data1$H))
counter = 1;KumSSH <- matrix(NA, nrow = (factorial(length(UnikHold))/(factorial((length(UnikHold)-2)))), ncol = 5)
m <- CreateMatrixes(data,"2015-07-19","2016-05-29",0,FALSE)
x <- m$DesignMatrix;Y <- m$KontingensTabel; r <- m$SamledeKampe;
f <- BTFunktioner(x=x)
for (hold1 in 1:length(UnikHold)) {
for (hold2 in 1:length(UnikHold)) {
if (hold1 != hold2){
KumSSH[counter,] <- cbind(Sandsynligheder(theta = theta,x = x,i = hold1, j = hold2)[1],Sandsynligheder(theta = theta,x = x,i = hold1, j = hold2)[2],Sandsynligheder(theta = theta,x = x,i = hold1, j = hold2)[3],UnikHold[hold1],UnikHold[hold2])
counter = counter +1
}
}
}
KumSSH[,1:3]=KumSSH[,1:3]*1.5
PointSSH
PointSSH[,1:3] <- PointSSH[,1:3]*1.5
PointSSH[,1] = as.numeric(PointSSH[,1]);PointSSH[,2] = as.numeric(PointSSH[,2]);PointSSH[,3] = as.numeric(PointSSH[,3])
PointSSH[,1:3] <- PointSSH[,1:3]*1.5
PointDyn <- rbind(c(as.character(aggregate(PointSSH$H,by = list(UnikHold = PointSSH$H1),FUN = sum)[,1])),c((aggregate(PointSSH$H,by = list(UnikHold = PointSSH$H1),FUN = sum)[,2]*3
+aggregate(PointSSH$U,by = list(UnikHold = PointSSH$H2),FUN = sum)[,2]*3
+aggregate(PointSSH$Uafgjort,by = list(UnikHold = PointSSH$H1),FUN = sum)[,2]
+aggregate(PointSSH$Uafgjort,by = list(UnikHold = PointSSH$H2),FUN = sum)[,2])))
PointDyn
PointSSH[,1:3] <- PointSSH[,1:3]/1.5
PointDyn <- rbind(c(as.character(aggregate(PointSSH$H,by = list(UnikHold = PointSSH$H1),FUN = sum)[,1])),c((aggregate(PointSSH$H,by = list(UnikHold = PointSSH$H1),FUN = sum)[,2]*3
+aggregate(PointSSH$U,by = list(UnikHold = PointSSH$H2),FUN = sum)[,2]*3
+aggregate(PointSSH$Uafgjort,by = list(UnikHold = PointSSH$H1),FUN = sum)[,2]
+aggregate(PointSSH$Uafgjort,by = list(UnikHold = PointSSH$H2),FUN = sum)[,2])))
PointDyn
56+48+35+40+35+44+40+17+36+38+49+40
styrker
MeanStyrker
MeanStyrker/min(MeanStyrker)
MeanTheta/(runde-4)
MeanBeta/(runde-4)
exp(t(x)%*%beta)
exp(t(x)%*%beta)/min(exp(t(x)%*%beta))
MeanTheta/(runde-4)
MeanSD/(runde-4)
MeanSD/(runde-3)
MeanSD/(runde-5)
MeanSD/(runde-4)
#Dynamisk model
MeanStyrker = 0;MeanBeta = 0; MeanTheta = 0; MeanSD = 0;
startrunde = 4;PointSSH = 0;PointSSH = c(0,0,0,"FCK","FCK","NN")
Fejl <- c(rep(0,length(unique(data$runde))-13))
for (runde in startrunde:(length(unique(data$runde))-4)) {
#Evaluerer modellen, ift. sandsynligheder for udfald mod de observerede udfald i næste runde
#Finder samtlige parvise sandsynligheder for ALLE sammenligninger
data1 <- data[which((data$runde <= runde) & (data$dato>="2015-07-19") & (data$dato<="2016-05-29")),]
m <- CreateMatrixes(data1,"2015-07-19","2016-05-29",0,FALSE)
x <- m$DesignMatrix;Y <- m$KontingensTabel; r <- m$SamledeKampe;
f <- BTFunktioner(x=x)
n <- NR(x,f);beta = n$beta;theta=n$theta;
styrker = n$styrker;
UnikHold <- sort(unique(data1$H))
counter = 1;KumSSH <- matrix(NA, nrow = (factorial(length(UnikHold))/(factorial((length(UnikHold)-2)))), ncol = 5)
m <- CreateMatrixes(data,"2015-07-19","2016-05-29",0,FALSE)
x <- m$DesignMatrix;Y <- m$KontingensTabel; r <- m$SamledeKampe;
f <- BTFunktioner(x=x)
for (hold1 in 1:length(UnikHold)) {
for (hold2 in 1:length(UnikHold)) {
if (hold1 != hold2){
KumSSH[counter,] <- cbind(Sandsynligheder(,theta,x,hold1,hold2)[1],Sandsynligheder(,theta,x,hold1,hold2)[2],Sandsynligheder(,theta,x,hold1,hold2)[3],UnikHold[hold1],UnikHold[hold2])
counter = counter +1
}
}
}
#Fikser data og sætter Holdene sammen i én column
KumSSH <- as.data.frame.matrix(KumSSH)
names(KumSSH) <- c("H","U","Uafgjort","H1","H2")
KumSSH$H1H2 <- paste(KumSSH$H1,KumSSH$H2)
#KumSSH <- KumSSH[,c(1:3,6)]
KumSSH[,1]<-as.numeric(paste(KumSSH[,1]));KumSSH[,2] <- as.numeric(paste(KumSSH[,2]));KumSSH[,3] <- as.numeric(paste(KumSSH[,3]));
#Finder næste rundes kampe for at evaluere
data1 <- data[which((data$runde==(runde+1)) & (data$dato>="2015-07-19") & (data$dato <= "2016-05-29")),]
data1$HU <- paste(data1$H,data1$U)
#Finder dertilhørende ssh
KumSSH <- KumSSH[KumSSH$H1H2 %in% data1$HU,];
PointSSH <- rbind(PointSSH,KumSSH)
Observationer <- as.data.frame.matrix(cbind(data1$Hsejr,data1$Usejr,data1$Uafgjort,data1$HU));
Observationer <- Observationer[order(Observationer$V4),];Observationer[,1] <- as.numeric(paste(Observationer[,1]));Observationer[,2] <- as.numeric(paste(Observationer[,2]));Observationer[,3] <- as.numeric(paste(Observationer[,3]));
Fejl[runde-9] = sum(Observationer[,1:3]-(KumSSH[,1:3]*Observationer[,1:3]))
MeanStyrker = MeanStyrker + n$styrker/(min(n$styrker))
MeanBeta= MeanBeta + n$beta
MeanTheta = MeanTheta + n$theta
MeanSD = MeanSD + n$sd
cat("\n",n$sd,"\n")
}
0.093473/0.105337
0.262980/0.015596
0.146925/0.220870
0.50/0.04
1.56/1.84
0.09/0.02
0.078/0.024
#TeamRatings <- c(67,63,66,67,66,72,69,66,64,63,66,64,65,62,64,64)
TeamRatings <- c(66,65,67,65,71,69,64,64,64,66,65,63)
x
names(x)
cbind(c(names(x)),TeamRatings)
TeamRatings <- cbind(c(names(x)),TeamRatings)
TeamRatings[,2]
TeamRatings[,2] <- as.numeric(TeamRatings[,2])
TeamRatings
as.numeric(TeamRatings[,2])
TeamRatings[,2] <- as.numeric(TeamRatings[,2])
TeamRatings
TeamRatings[,2] <- as.numeric(TeamRatings[,2])
TeamRatings[,2] <- as.numeric(TeamRatings[,2])
TeamRatings
TeamRatings[,2]
as.numeric(TeamRatings[,2])
TeamRatings[,1]
names(x)
TeamRatings <- KumSSH[TeamRatings[,1] %in% names(x),];
TeamRatings
#TeamRatings <- c(67,63,66,67,66,72,69,66,64,63,66,64,65,62,64,64)
TeamRatings <- c(66,65,67,65,71,69,64,64,64,66,65,63)
TeamRatings <- cbind(c(names(x)),TeamRatings)
TeamRatings
TeamRatings <- KumSSH[TeamRatings[,1] %in% names(x),];
TeamRatings
#TeamRatings <- c(67,63,66,67,66,72,69,66,64,63,66,64,65,62,64,64)
TeamRatings <- c(66,65,67,65,71,69,64,64,64,66,65,63)
TeamRatings <- cbind(c(names(x)),TeamRatings)
TeamRatings[,2] <- as.numeric(TeamRatings[,2])
TeamRatings
x
TeamRatings <- TeamRatings[TeamRatings[,1] %in% names(x),];
TeamRatings
library(BTSoccer)
#Dynamisk model
MeanStyrker = 0;MeanBeta = 0; MeanTheta = 0; MeanSD = 0;
startrunde = 4;PointSSH = 0;PointSSH = c(0,0,0,"FCK","FCK","NN")
Fejl <- c(rep(0,length(unique(data$runde))-13))
for (runde in startrunde:(length(unique(data$runde))-4)) {
#Evaluerer modellen, ift. sandsynligheder for udfald mod de observerede udfald i næste runde
#Finder samtlige parvise sandsynligheder for ALLE sammenligninger
data1 <- data[which((data$runde <= runde) & (data$dato>="2015-07-19") & (data$dato<="2016-05-29")),]
m <- CreateMatrixes(data1,"2015-07-19","2016-05-29",0,FALSE)
x <- m$DesignMatrix;Y <- m$KontingensTabel; r <- m$SamledeKampe;
f <- BTFunktioner(x=x)
n <- NR(x,f);beta = n$beta;theta=n$theta;
styrker = n$styrker;
UnikHold <- sort(unique(data1$H))
counter = 1;KumSSH <- matrix(NA, nrow = (factorial(length(UnikHold))/(factorial((length(UnikHold)-2)))), ncol = 5)
m <- CreateMatrixes(data,"2015-07-19","2016-05-29",0,FALSE)
x <- m$DesignMatrix;Y <- m$KontingensTabel; r <- m$SamledeKampe;
f <- BTFunktioner(x=x)
for (hold1 in 1:length(UnikHold)) {
for (hold2 in 1:length(UnikHold)) {
if (hold1 != hold2){
KumSSH[counter,] <- cbind(Sandsynligheder(,theta,x,hold1,hold2)[1],Sandsynligheder(,theta,x,hold1,hold2)[2],Sandsynligheder(,theta,x,hold1,hold2)[3],UnikHold[hold1],UnikHold[hold2])
counter = counter +1
}
}
}
#Fikser data og sætter Holdene sammen i én column
KumSSH <- as.data.frame.matrix(KumSSH)
names(KumSSH) <- c("H","U","Uafgjort","H1","H2")
KumSSH$H1H2 <- paste(KumSSH$H1,KumSSH$H2)
#KumSSH <- KumSSH[,c(1:3,6)]
KumSSH[,1]<-as.numeric(paste(KumSSH[,1]));KumSSH[,2] <- as.numeric(paste(KumSSH[,2]));KumSSH[,3] <- as.numeric(paste(KumSSH[,3]));
#Finder næste rundes kampe for at evaluere
data1 <- data[which((data$runde==(runde+1)) & (data$dato>="2015-07-19") & (data$dato <= "2016-05-29")),]
data1$HU <- paste(data1$H,data1$U)
#Finder dertilhørende ssh
KumSSH <- KumSSH[KumSSH$H1H2 %in% data1$HU,];
PointSSH <- rbind(PointSSH,KumSSH)
Observationer <- as.data.frame.matrix(cbind(data1$Hsejr,data1$Usejr,data1$Uafgjort,data1$HU));
Observationer <- Observationer[order(Observationer$V4),];Observationer[,1] <- as.numeric(paste(Observationer[,1]));Observationer[,2] <- as.numeric(paste(Observationer[,2]));Observationer[,3] <- as.numeric(paste(Observationer[,3]));
Fejl[runde-9] = sum(Observationer[,1:3]-(KumSSH[,1:3]*Observationer[,1:3]))
MeanStyrker = MeanStyrker + n$styrker/(min(n$styrker))
MeanBeta= MeanBeta + n$beta
MeanTheta = MeanTheta + n$theta
MeanSD = MeanSD + n$sd
cat("\n",n$sd,"\n")
}
MeanTheta/(runde-4)
MeanBeta/(runde-4)
exp(t(x)%*%beta)/min(exp(t(x)%*%beta))
exp(t(x)%*%beta)/min(exp(t(x)%*%beta))
n$styrker
n$styrker/min(n$styrker)
#Til at estimere point, ssh*point for udfald, eks: (0.34,0.26,0.5)*(3,3,1)
data1 <- data[which((data$dato>="2015-07-19") & (data$dato<="2016-05-29")),]
UnikHold <- sort(unique(data1$H))
counter = 1;KumSSH <- matrix(NA, nrow = (factorial(length(UnikHold))/(factorial((length(UnikHold)-2)))), ncol = 5)
m <- CreateMatrixes(data,"2015-07-19","2016-05-29",0,FALSE)
x <- m$DesignMatrix;Y <- m$KontingensTabel; r <- m$SamledeKampe;
f <- BTFunktioner(x=x)
for (hold1 in 1:length(UnikHold)) {
for (hold2 in 1:length(UnikHold)) {
if (hold1 != hold2){
KumSSH[counter,] <- cbind(Sandsynligheder(theta = theta,x = x,i = hold1, j = hold2)[1],Sandsynligheder(theta = theta,x = x,i = hold1, j = hold2)[2],Sandsynligheder(theta = theta,x = x,i = hold1, j = hold2)[3],UnikHold[hold1],UnikHold[hold2])
counter = counter +1
}
}
}
PointSSH
PointSSH[,1] = as.numeric(PointSSH[,1]);PointSSH[,2] = as.numeric(PointSSH[,2]);PointSSH[,3] = as.numeric(PointSSH[,3])
PointDyn <- rbind(c(as.character(aggregate(PointSSH$H,by = list(UnikHold = PointSSH$H1),FUN = sum)[,1])),c((aggregate(PointSSH$H,by = list(UnikHold = PointSSH$H1),FUN = sum)[,2]*3
+aggregate(PointSSH$U,by = list(UnikHold = PointSSH$H2),FUN = sum)[,2]*3
+aggregate(PointSSH$Uafgjort,by = list(UnikHold = PointSSH$H1),FUN = sum)[,2]
+aggregate(PointSSH$Uafgjort,by = list(UnikHold = PointSSH$H2),FUN = sum)[,2])))
PointDyn
PointSSH[,1:3] <- PointSSH[,1:3]/1.5
PointDyn <- rbind(c(as.character(aggregate(PointSSH$H,by = list(UnikHold = PointSSH$H1),FUN = sum)[,1])),c((aggregate(PointSSH$H,by = list(UnikHold = PointSSH$H1),FUN = sum)[,2]*3
+aggregate(PointSSH$U,by = list(UnikHold = PointSSH$H2),FUN = sum)[,2]*3
+aggregate(PointSSH$Uafgjort,by = list(UnikHold = PointSSH$H1),FUN = sum)[,2]
+aggregate(PointSSH$Uafgjort,by = list(UnikHold = PointSSH$H2),FUN = sum)[,2])))
PointDyn
PointSSH[,1:3] <- PointSSH[,1:3]*1.5
PointSSH[,1:3] <- PointSSH[,1:3]*1.5
PointDyn <- rbind(c(as.character(aggregate(PointSSH$H,by = list(UnikHold = PointSSH$H1),FUN = sum)[,1])),c((aggregate(PointSSH$H,by = list(UnikHold = PointSSH$H1),FUN = sum)[,2]*3
+aggregate(PointSSH$U,by = list(UnikHold = PointSSH$H2),FUN = sum)[,2]*3
+aggregate(PointSSH$Uafgjort,by = list(UnikHold = PointSSH$H1),FUN = sum)[,2]
+aggregate(PointSSH$Uafgjort,by = list(UnikHold = PointSSH$H2),FUN = sum)[,2])))
PointDyn
PointSSH
PointDyn <- rbind(c(as.character(aggregate(PointSSH$H,by = list(UnikHold = PointSSH$H1),FUN = sum)[,1])),c((aggregate(PointSSH$H,by = list(UnikHold = PointSSH$H1),FUN = sum)[,2]*3
+aggregate(PointSSH$U,by = list(UnikHold = PointSSH$H2),FUN = sum)[,2]*3
+aggregate(PointSSH$Uafgjort,by = list(UnikHold = PointSSH$H1),FUN = sum)[,2]
+aggregate(PointSSH$Uafgjort,by = list(UnikHold = PointSSH$H2),FUN = sum)[,2])))
PointDyn
PointSSH[,1:3] <- PointSSH[,1:3]/1.5
PointDyn <- rbind(c(as.character(aggregate(PointSSH$H,by = list(UnikHold = PointSSH$H1),FUN = sum)[,1])),c((aggregate(PointSSH$H,by = list(UnikHold = PointSSH$H1),FUN = sum)[,2]*3
+aggregate(PointSSH$U,by = list(UnikHold = PointSSH$H2),FUN = sum)[,2]*3
+aggregate(PointSSH$Uafgjort,by = list(UnikHold = PointSSH$H1),FUN = sum)[,2]
+aggregate(PointSSH$Uafgjort,by = list(UnikHold = PointSSH$H2),FUN = sum)[,2])))
PointDyn
styrker
styrker = n$styrker/min(n$styrker)
styrker
PointDyn
MeanBeta/(runde-4)
x
MeanTheta/(runde-4)
MeanSD/(runde-4)
MeanSD
MeanSD/(runde-4)
#Dynamisk model
MeanStyrker = 0;MeanBeta = 0; MeanTheta = 0; MeanSD = 0;
startrunde = 4;PointSSH = 0;PointSSH = c(0,0,0,"FCK","FCK","NN")
Fejl <- c(rep(0,length(unique(data$runde))-13))
for (runde in startrunde:(length(unique(data$runde))-4)) {
#Evaluerer modellen, ift. sandsynligheder for udfald mod de observerede udfald i næste runde
#Finder samtlige parvise sandsynligheder for ALLE sammenligninger
data1 <- data[which((data$runde <= runde) & (data$dato>="2015-07-19") & (data$dato<="2016-05-29")),]
m <- CreateMatrixes(data1,"2015-07-19","2016-05-29",0,FALSE)
x <- m$DesignMatrix;Y <- m$KontingensTabel; r <- m$SamledeKampe;
f <- BTFunktioner(x=x)
n <- NR(x,f);beta = n$beta;theta=n$theta;
styrker = n$styrker;
UnikHold <- sort(unique(data1$H))
counter = 1;KumSSH <- matrix(NA, nrow = (factorial(length(UnikHold))/(factorial((length(UnikHold)-2)))), ncol = 5)
m <- CreateMatrixes(data,"2015-07-19","2016-05-29",0,FALSE)
x <- m$DesignMatrix;Y <- m$KontingensTabel; r <- m$SamledeKampe;
f <- BTFunktioner(x=x)
for (hold1 in 1:length(UnikHold)) {
for (hold2 in 1:length(UnikHold)) {
if (hold1 != hold2){
KumSSH[counter,] <- cbind(Sandsynligheder(,theta,x,hold1,hold2)[1],Sandsynligheder(,theta,x,hold1,hold2)[2],Sandsynligheder(,theta,x,hold1,hold2)[3],UnikHold[hold1],UnikHold[hold2])
counter = counter +1
}
}
}
#Fikser data og sætter Holdene sammen i én column
KumSSH <- as.data.frame.matrix(KumSSH)
names(KumSSH) <- c("H","U","Uafgjort","H1","H2")
KumSSH$H1H2 <- paste(KumSSH$H1,KumSSH$H2)
#KumSSH <- KumSSH[,c(1:3,6)]
KumSSH[,1]<-as.numeric(paste(KumSSH[,1]));KumSSH[,2] <- as.numeric(paste(KumSSH[,2]));KumSSH[,3] <- as.numeric(paste(KumSSH[,3]));
#Finder næste rundes kampe for at evaluere
data1 <- data[which((data$runde==(runde+1)) & (data$dato>="2015-07-19") & (data$dato <= "2016-05-29")),]
data1$HU <- paste(data1$H,data1$U)
#Finder dertilhørende ssh
KumSSH <- KumSSH[KumSSH$H1H2 %in% data1$HU,];
PointSSH <- rbind(PointSSH,KumSSH)
Observationer <- as.data.frame.matrix(cbind(data1$Hsejr,data1$Usejr,data1$Uafgjort,data1$HU));
Observationer <- Observationer[order(Observationer$V4),];Observationer[,1] <- as.numeric(paste(Observationer[,1]));Observationer[,2] <- as.numeric(paste(Observationer[,2]));Observationer[,3] <- as.numeric(paste(Observationer[,3]));
Fejl[runde-9] = sum(Observationer[,1:3]-(KumSSH[,1:3]*Observationer[,1:3]))
MeanStyrker = MeanStyrker + n$styrker/(min(n$styrker))
MeanBeta= MeanBeta + n$beta
MeanTheta = MeanTheta + n$theta
MeanSD = MeanSD + n$sd
#cat("\n",n$sd,"\n")
}
MeanSD/(runde-4)
#Dynamisk model
MeanStyrker = 0;MeanBeta = 0; MeanTheta = 0; MeanSD = 0;
startrunde = 4;PointSSH = 0;PointSSH = c(0,0,0,"FCK","FCK","NN")
Fejl <- c(rep(0,length(unique(data$runde))-13))
for (runde in startrunde:(length(unique(data$runde))-4)) {
#Evaluerer modellen, ift. sandsynligheder for udfald mod de observerede udfald i næste runde
#Finder samtlige parvise sandsynligheder for ALLE sammenligninger
data1 <- data[which((data$runde <= runde) & (data$dato>="2015-07-19") & (data$dato<="2016-05-29")),]
m <- CreateMatrixes(data1,"2015-07-19","2016-05-29",0,FALSE)
x <- m$DesignMatrix;Y <- m$KontingensTabel; r <- m$SamledeKampe;
f <- BTFunktioner(x=x)
n <- NR(x,f);beta = n$beta;theta=n$theta;
styrker = n$styrker;
UnikHold <- sort(unique(data1$H))
counter = 1;KumSSH <- matrix(NA, nrow = (factorial(length(UnikHold))/(factorial((length(UnikHold)-2)))), ncol = 5)
m <- CreateMatrixes(data,"2015-07-19","2016-05-29",0,FALSE)
x <- m$DesignMatrix;Y <- m$KontingensTabel; r <- m$SamledeKampe;
f <- BTFunktioner(x=x)
for (hold1 in 1:length(UnikHold)) {
for (hold2 in 1:length(UnikHold)) {
if (hold1 != hold2){
KumSSH[counter,] <- cbind(Sandsynligheder(,theta,x,hold1,hold2)[1],Sandsynligheder(,theta,x,hold1,hold2)[2],Sandsynligheder(,theta,x,hold1,hold2)[3],UnikHold[hold1],UnikHold[hold2])
counter = counter +1
}
}
}
#Fikser data og sætter Holdene sammen i én column
KumSSH <- as.data.frame.matrix(KumSSH)
names(KumSSH) <- c("H","U","Uafgjort","H1","H2")
KumSSH$H1H2 <- paste(KumSSH$H1,KumSSH$H2)
#KumSSH <- KumSSH[,c(1:3,6)]
KumSSH[,1]<-as.numeric(paste(KumSSH[,1]));KumSSH[,2] <- as.numeric(paste(KumSSH[,2]));KumSSH[,3] <- as.numeric(paste(KumSSH[,3]));
#Finder næste rundes kampe for at evaluere
data1 <- data[which((data$runde==(runde+1)) & (data$dato>="2015-07-19") & (data$dato <= "2016-05-29")),]
data1$HU <- paste(data1$H,data1$U)
#Finder dertilhørende ssh
KumSSH <- KumSSH[KumSSH$H1H2 %in% data1$HU,];
PointSSH <- rbind(PointSSH,KumSSH)
Observationer <- as.data.frame.matrix(cbind(data1$Hsejr,data1$Usejr,data1$Uafgjort,data1$HU));
Observationer <- Observationer[order(Observationer$V4),];Observationer[,1] <- as.numeric(paste(Observationer[,1]));Observationer[,2] <- as.numeric(paste(Observationer[,2]));Observationer[,3] <- as.numeric(paste(Observationer[,3]));
Fejl[runde-9] = sum(Observationer[,1:3]-(KumSSH[,1:3]*Observationer[,1:3]))
MeanStyrker = MeanStyrker + n$styrker/(min(n$styrker))
MeanBeta= MeanBeta + n$beta
MeanTheta = MeanTheta + n$theta
MeanSD = MeanSD + n$sd
#cat("\n",n$sd,"\n")
}
MeanSD/(runde-4)
runde
MeanBeta/(runde-3)
MeanBeta/(runde-4)
MeanSD/(runde-3)
#Henter og verificerer data
data <- read.table("Kampe_r1.csv",header=T,sep=",")
data$H <- as.character(data$H)
data$U <- as.character(data$U)
data$dato <- as.Date(data$dato, format = "%m/%d/%Y")
m <- CreateMatrixes(data,"2015-07-19","2016-05-29",0,TRUE)
x <- m$DesignMatrix;Y <- m$KontingensTabel; r <- m$SamledeKampe;
#Henter og verificerer data
data <- read.table("Kampe_r1.csv",header=T,sep=",")
data$H <- as.character(data$H)
data$U <- as.character(data$U)
data$dato <- as.Date(data$dato, format = "%m/%d/%Y")
m <- CreateMatrixes(data,"2015-07-19","2016-05-29",0,TRUE)
x
#git add Probabilities.R #git commit -m "Navn på ændring" #git push #git pull
rm(list=ls())
library(matlib) #Til vektor/matrix regning
library(blockmatrix) #matrixopsætning
library(tidyr) #Til data transformation
library(xtable) #Til Latex table
library(BTSoccer)
setwd("C:/Users/lucas/Desktop/Odd")
#Henter og verificerer data
data <- read.table("Kampe_r1.csv",header=T,sep=",")
data$H <- as.character(data$H)
data$U <- as.character(data$U)
data$dato <- as.Date(data$dato, format = "%m/%d/%Y")
m <- CreateMatrixes(data,"2015-07-19","2016-05-29",0,TRUE)
m <- CreateMatrixes(data,"2015-07-19","2016-05-29",0,TRUE)
UnikHold
library(BTSoccer)
#Henter og verificerer data
data <- read.table("Kampe_r1.csv",header=T,sep=",")
data$H <- as.character(data$H)
data$U <- as.character(data$U)
data$dato <- as.Date(data$dato, format = "%m/%d/%Y")
m <- CreateMatrixes(data,"2015-07-19","2016-05-29",0,TRUE)
#Henter og verificerer data
data <- read.table("Kampe_r1.csv",header=T,sep=",")
data$H <- as.character(data$H)
data$U <- as.character(data$U)
data$dato <- as.Date(data$dato, format = "%m/%d/%Y")
m <- CreateMatrixes(data,"2015-07-19","2016-05-29",0,TRUE)
library(BTSoccer)
setwd("C:/Users/lucas/Desktop/Odd")
#Henter og verificerer data
data <- read.table("Kampe_r1.csv",header=T,sep=",")
data$H <- as.character(data$H)
data$U <- as.character(data$U)
data$dato <- as.Date(data$dato, format = "%m/%d/%Y")
m <- CreateMatrixes(data,"2015-07-19","2016-05-29",0,TRUE)
#git add Probabilities.R #git commit -m "Navn på ændring" #git push #git pull
rm(list=ls())
library(matlib) #Til vektor/matrix regning
library(blockmatrix) #matrixopsætning
library(tidyr) #Til data transformation
library(xtable) #Til Latex table
library(BTSoccer)
setwd("C:/Users/lucas/Desktop/Odd")
#Henter og verificerer data
data <- read.table("Kampe_r1.csv",header=T,sep=",")
data$H <- as.character(data$H)
data$U <- as.character(data$U)
data$dato <- as.Date(data$dato, format = "%m/%d/%Y")
m <- CreateMatrixes(data,"2015-07-19","2016-05-29",0,TRUE)
UnikHold
library(BTSoccer)
setwd("C:/Users/lucas/Desktop/Odd")
#Henter og verificerer data
data <- read.table("Kampe_r1.csv",header=T,sep=",")
data$H <- as.character(data$H)
data$U <- as.character(data$U)
data$dato <- as.Date(data$dato, format = "%m/%d/%Y")
m <- CreateMatrixes(data,"2015-07-19","2016-05-29",0,TRUE)
#git add Probabilities.R #git commit -m "Navn på ændring" #git push #git pull
rm(list=ls())
library(matlib) #Til vektor/matrix regning
library(blockmatrix) #matrixopsætning
library(tidyr) #Til data transformation
library(xtable) #Til Latex table
library(BTSoccer)
setwd("C:/Users/lucas/Desktop/Odd")
#Henter og verificerer data
data <- read.table("Kampe_r1.csv",header=T,sep=",")
data$H <- as.character(data$H)
data$U <- as.character(data$U)
data$dato <- as.Date(data$dato, format = "%m/%d/%Y")
m <- CreateMatrixes(data,"2015-07-19","2016-05-29",0,TRUE)
